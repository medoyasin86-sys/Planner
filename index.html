<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>MYH Master Planner 2026 - Spread Edition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.10/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.10/vfs_fonts.js"></script>
    <style>
        :root { --royal: #0f172a; --ruby: #9f1239; --emerald: #064e3b; --gold: #b8860b; }
        body { font-family: system-ui, sans-serif; background: #f1f5f9; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .setup-box { background: white; padding: 40px; border-radius: 25px; text-align: center; border-bottom: 8px solid var(--gold); box-shadow: 0 20px 50px rgba(0,0,0,0.1); }
        .btn-gen { background: var(--royal); color: var(--gold); border: 2px solid var(--gold); padding: 15px 40px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 18px; transition: 0.3s; }
        .btn-gen:hover { background: var(--gold); color: white; transform: translateY(-3px); }
        .status { margin-top: 15px; color: var(--emerald); font-weight: bold; }
    </style>
</head>
<body>

<div class="setup-box">
    <h1 style="color: var(--royal);">MYH Master Planner 2026</h1>
    <p style="color: #64748b;">Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¬Ù†Ø¯Ø© Ø§Ù„Ù…ØªÙ‚Ø§Ø¨Ù„Ø© Ù…Ø¹ Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ø°ÙƒÙŠ</p>
    <input type="file" id="fontFile" accept=".ttf" style="margin: 20px 0;" />
    <br>
    <button class="btn-gen" id="genBtn">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø¬Ù†Ø¯Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© ğŸ“’</button>
    <div id="status" class="status"></div>
</div>

<script>
    let fontB64 = "";
    document.getElementById('fontFile').onchange = (e) => {
        const reader = new FileReader();
        reader.onload = () => { 
            fontB64 = reader.result.split(',')[1]; 
            document.getElementById('status').innerText = "âœ… Ø§Ù„Ø®Ø· Ù…Ø¯Ù…Ø¬ Ø§Ù„Ø¢Ù†";
        };
        reader.readAsDataURL(e.target.files[0]);
    };

    const THEME = { royal: "#0f172a", ruby: "#9f1239", emerald: "#064e3b", gold: "#b8860b", bg: "#fdfbf7", line: "#e2e8f0" };
    const months = ["ÙŠÙ†Ø§ÙŠØ±", "ÙØ¨Ø±Ø§ÙŠØ±", "Ù…Ø§Ø±Ø³", "Ø£Ø¨Ø±ÙŠÙ„", "Ù…Ø§ÙŠÙˆ", "ÙŠÙˆÙ†ÙŠÙˆ", "ÙŠÙˆÙ„ÙŠÙˆ"];

    function getSchedule12h() {
        let times = [];
        let start = new Date(); start.setHours(7, 35, 0);
        for(let i=1; i<=8; i++) {
            let h = start.getHours();
            let m = start.getMinutes().toString().padStart(2,'0');
            let ampm = h >= 12 ? 'Ù…' : 'Øµ';
            let displayH = h % 12 || 12;
            let startStr = `${displayH}:${m} ${ampm}`;
            
            let end = new Date(start.getTime() + 40 * 60000);
            let eh = end.getHours();
            let em = end.getMinutes().toString().padStart(2,'0');
            let eampm = eh >= 12 ? 'Ù…' : 'Øµ';
            let edisplayH = eh % 12 || 12;
            let endStr = `${edisplayH}:${em} ${eampm}`;

            times.push(`${startStr} - ${endStr}`);
            if(i === 4) start = new Date(end.getTime() + 25 * 60000); 
            else start = new Date(end.getTime() + 5 * 60000);
        }
        return times;
    }

    // Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Tabs)
    function drawSideTabs(currentMonthIdx) {
        return months.map((m, idx) => ({
            text: m,
            linkToDestination: 'm-' + idx,
            fontSize: 10,
            color: 'white',
            alignment: 'center',
            margin: [0, 4, 0, 4],
            fillColor: (idx === currentMonthIdx) ? THEME.gold : THEME.royal
        }));
    }

    document.getElementById('genBtn').onclick = () => {
        if(!fontB64) return alert("ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø§Ù„Ø®Ø· Ø£ÙˆÙ„Ø§Ù‹");
        document.getElementById('status').innerText = "â³ ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø®ÙŠØ§Ø·Ø© Ø§Ù„ØµÙØ­Ø§Øª Ø±Ù‚Ù…ÙŠØ§Ù‹...";

        pdfMake.vfs = { 'F.ttf': fontB64 };
        pdfMake.fonts = { MyFont: { normal: 'F.ttf', bold: 'F.ttf', italics: 'F.ttf' } };

        const schedule = getSchedule12h();
        let docContent = [];

        // 1. Ø§Ù„ØºÙ„Ø§Ù
        docContent.push({
            stack: [
                { text: '2026', fontSize: 110, color: THEME.gold, bold: true, margin: [0, 150, 0, 0] },
                { text: 'Mr. Mo. Yasin', fontSize: 50, color: 'white', italics: true, margin: [0, 15] },
                { canvas: [{ type: 'line', x1: 250, y1: 0, x2: 450, y2: 0, lineWidth: 2, lineColor: THEME.gold }] },
                { text: 'PROFESSIONAL INTERACTIVE PLANNER', fontSize: 14, color: THEME.gold, margin: [0, 40], letterSpacing: 6 }
            ],
            fillColor: THEME.royal, alignment: 'center', pageBreak: 'after'
        });

        let start = new Date(2026, 0, 1);
        let end = new Date(2026, 6, 31);

        for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
            let monthIdx = d.getMonth();
            let dateStr = d.toLocaleDateString('ar-OM', { weekday: 'long', day: 'numeric', month: 'long' });
            let pageId = d.getDate() === 1 ? { id: 'm-' + monthIdx } : {};

            // --- ØµÙØ­Ø© Ø§Ù„ÙŠÙ…ÙŠÙ† (Ø§Ù„Ø¹Ù…Ù„) ---
            docContent.push({
                ...pageId,
                background: function(page) {
                    return { canvas: [{ type: 'rect', x: 800, y: 100, w: 40, h: 300, r: 5, fillColor: THEME.royal }] };
                },
                padding: [30, 20, 50, 20],
                stack: [
                    // Ø§Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
                    {
                        absolutePosition: { x: 810, y: 110 },
                        stack: drawSideTabs(monthIdx)
                    },
                    {
                        columns: [
                            { text: 'Mr. Mo. Yasin', fontSize: 24, color: THEME.gold, italics: true },
                            { text: dateStr, fontSize: 18, color: THEME.royal, bold: true, alignment: 'left' }
                        ]
                    },
                    { canvas: [{ type: 'line', x1: 0, y1: 5, x2: 750, y2: 5, lineWidth: 1, lineColor: THEME.ruby }] },
                    {
                        margin: [0, 20, 0, 0],
                        columns: [
                            {
                                width: '30%',
                                stack: [
                                    { text: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ (12h)', color: THEME.ruby, bold: true, margin: [0, 5] },
                                    { table: { widths: ['*'], body: schedule.map(t => [{text: t, fontSize: 10, margin: [0, 6]}]) }, layout: 'lightHorizontalLines' }
                                ]
                            },
                            {
                                width: '65%', margin: [20, 0, 0, 0],
                                stack: [
                                    { text: 'Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªØ­Ø¶ÙŠØ± ÙˆØ§Ù„Ø¬ÙˆØ§Ù‡Ø±', color: THEME.ruby, bold: true },
                                    ...Array(5).fill(0).map(() => ({
                                        margin: [0, 5],
                                        canvas: [{ type: 'rect', x: 0, y: 0, w: 450, h: 75, r: 8, lineColor: THEME.line, fillColor: '#ffffff' }]
                                    }))
                                ]
                            }
                        ]
                    }
                ], pageBreak: 'after'
            });

            // --- ØµÙØ­Ø© Ø§Ù„ÙŠØ³Ø§Ø± (Ø§Ù„Ø­ÙŠØ§Ø©) ---
            docContent.push({
                background: function(page) {
                    return { canvas: [{ type: 'rect', x: 800, y: 100, w: 40, h: 300, r: 5, fillColor: THEME.royal }] };
                },
                padding: [30, 20, 50, 20],
                stack: [
                    {
                        absolutePosition: { x: 810, y: 110 },
                        stack: drawSideTabs(monthIdx)
                    },
                    {
                        columns: [
                            { text: 'Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ§Ù„Ø­Ø³Ø§Ø¨Ø§Øª', fontSize: 20, color: THEME.emerald, bold: true },
                            { text: 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙÙ‡Ø±Ø³ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', linkToDestination: 'm-0', fontSize: 10, color: THEME.ruby, alignment: 'left' }
                        ]
                    },
                    {
                        margin: [0, 20, 0, 0],
                        columns: [
                            {
                                width: '45%',
                                stack: [
                                    { text: 'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©', color: THEME.emerald, bold: true, margin: [0, 5] },
                                    { table: { widths: [15, '*'], body: Array(12).fill([{text:''}, {text:'', margin:[0,8]}]) } }
                                ]
                            },
                            {
                                width: '45%', margin: [25, 0, 0, 0],
                                stack: [
                                    { text: 'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª (Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ù…Ø±Ø¯)', color: THEME.emerald, bold: true },
                                    {
                                        table: {
                                            widths: ['*', 'auto', 'auto'],
                                            body: [
                                                [{text: 'Ø§Ù„Ø¨ÙŠØ§Ù†', fillColor: THEME.emerald, color: 'white'}, {text: 'Ø¯Ø®Ù„', fillColor: THEME.emerald, color: 'white'}, {text: 'ØµØ±Ù', fillColor: THEME.emerald, color: 'white'}],
                                                ...Array(6).fill([{text:''}, '', '']),
                                                [{text: 'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ', bold: true}, {colSpan: 2, text: ''}]
                                            ]
                                        }
                                    },
                                    { text: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙŠØ§Ù‚ÙˆØª', color: THEME.ruby, bold: true, margin: [0, 20, 0, 5] },
                                    { canvas: [{ type: 'rect', x: 0, y: 0, w: 320, h: 120, r: 10, lineColor: THEME.line }] }
                                ]
                            }
                        ]
                    }
                ], pageBreak: 'after'
            });
        }

        const docDefinition = {
            pageSize: { width: 842, height: 595 }, // iPad Landscape
            defaultStyle: { font: 'MyFont', alignment: 'right' },
            content: docContent
        };

        pdfMake.createPdf(docDefinition).download('MYH_Master_2026.pdf');
        document.getElementById('status').innerText = "âœ… ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø±Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ø¢Ù†.";
    };
</script>

</body>
</html>
