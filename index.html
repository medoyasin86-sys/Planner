<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>بلانر أ/ محمد ياسين حلمي - احترافي وشخصي</title>

  <!-- خطوط -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <!-- أيقونات -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root{
      /* لوحة فاخرة للتبويبات */
      --ruby:#9B1C31;
      --navy:#0B1A39;
      --emerald:#0F7A5F;
      --marmoreal:#E7DCC8;
      --white:#FFFFFF;

      /* محايدة */
      --light-gray:#f6f7fb;
      --dark-gray-text:#333;
      --paper:#fff;
      --ruled-line:#e9e9e9;

      --body-font:'Cairo',sans-serif;
    }

    html,body{
      margin:0;
      padding:0;
      height:100%;
      background:var(--light-gray);
      color:var(--dark-gray-text);
      font-family:var(--body-font);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      touch-action:manipulation;
    }

    /* ===== مظهر الكتاب المفتوح ===== */
    .planner-container{
      position: relative;
      display:flex;
      gap:0;
      max-width:1800px;
      margin:0 auto;
      padding:18px;
      align-items:stretch;
      justify-content:center;
      perspective:2200px;
    }
    .planner-page{
      flex:1;
      background:var(--paper);
      border-radius:22px;
      padding:28px;
      display:flex;
      flex-direction:column;
      min-height:900px;
      position:relative;
      overflow:hidden;
      box-shadow:
        0 10px 28px rgba(0,0,0,.12),
        inset -10px 0 18px rgba(0,0,0,.06);
      transform-origin:right center;
      transform: rotateY(-3deg);
      transition: transform .35s ease, box-shadow .35s ease;
    }
    .professional-page{
      transform-origin:left center;
      transform: rotateY(3deg);
      box-shadow:
        0 10px 28px rgba(0,0,0,.12),
        inset 10px 0 18px rgba(0,0,0,.06);
    }

    /* رأس الصفحة */
    .header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:18px;
      padding-bottom:14px;
      border-bottom:1px solid #eee;
    }
    .header .logo{
      font-size:2.2em;
      color:#888;
      letter-spacing:3px;
      font-weight:700;
      user-select:none;
    }
    .header .title{ flex:1; text-align:right; }
    .header h1{
      font-weight:700;
      margin:0;
      font-size:1.45em;
      color:#222;
      letter-spacing:.2px;
    }
    .header p{
      margin:6px 0 0;
      font-size:.9em;
      color:#777;
    }

    /* تبويبات ملونة (الألوان على التبويبات فقط) */
    .tabs-section{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-bottom:16px;
    }
    .tab-button{
      display:flex;
      align-items:center;
      gap:10px;
      background:#fff;
      padding:12px 16px;
      border-radius:12px;
      color:#333;
      border:1px solid #e8e8ea;
      text-decoration:none;
      cursor:pointer;
      text-align:right;
      transition:transform .15s ease, background-color .2s ease, color .2s ease, box-shadow .2s ease, border-color .2s ease;
      box-shadow:0 2px 6px rgba(0,0,0,.05);
      width:100%;
    }
    .tab-button i{ font-size:1.1em; }

    /* حالات الألوان */
    .tab-ruby{ border-color:rgba(155,28,49,.25); }
    .tab-ruby i{ color:var(--ruby); }
    .tab-ruby:hover, .tab-ruby.active{
      background:var(--ruby); color:#fff; border-color:var(--ruby); box-shadow:0 4px 10px rgba(155,28,49,.25);
    }
    .tab-navy{ border-color:rgba(11,26,57,.25); }
    .tab-navy i{ color:var(--navy); }
    .tab-navy:hover, .tab-navy.active{
      background:var(--navy); color:#fff; border-color:var(--navy); box-shadow:0 4px 10px rgba(11,26,57,.25);
    }
    .tab-emerald{ border-color:rgba(15,122,95,.25); }
    .tab-emerald i{ color:var(--emerald); }
    .tab-emerald:hover, .tab-emerald.active{
      background:var(--emerald); color:#fff; border-color:var(--emerald); box-shadow:0 4px 10px rgba(15,122,95,.25);
    }
    .tab-marmoreal{ border-color:#e5d8c6; background:#fbf9f6; }
    .tab-marmoreal i{ color:#9a8364; }
    .tab-marmoreal:hover, .tab-marmoreal.active{
      background:#e9decd; color:#3d352b; border-color:#d7cab6; box-shadow:0 4px 10px rgba(154,131,100,.18);
    }
    .tab-white{ border-color:#e8e8ea; background:#fff; }
    .tab-white i{ color:#7b7b7f; }
    .tab-white:hover, .tab-white.active{
      background:#f4f6ff; color:#0B1A39; border-color:#cdd3ff; box-shadow:0 4px 10px rgba(11,26,57,.15);
    }

    .tab-button.disabled{
      opacity:.55; cursor:not-allowed; filter:grayscale(.35); pointer-events:none;
    }

    .placeholder-note{
      padding:14px;
      background:#fafbfd;
      border:1px dashed #e6e7ee;
      border-radius:12px;
      color:#666;
      font-size:.95em;
    }

    /* ===== الحلقات الفضية الواقعية (حلقتان) ===== */
    .center-binder{
      width:62px;
      min-width:62px;
      margin:0 14px;
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:space-between;
      padding:50px 0;
    }
    .center-binder::before{
      /* ظل عمودي بين الصفحتين */
      content:"";
      position:absolute;
      top:30px; bottom:30px; width:10px;
      background: radial-gradient(closest-side, rgba(0,0,0,.16), rgba(0,0,0,.05) 60%, transparent 70%);
      filter: blur(1px);
      border-radius:10px;
      left:50%; transform:translateX(-50%);
      z-index:0;
    }
    .ring{
      width:54px; height:54px; border-radius:50%;
      position:relative; z-index:2;
      background:
        radial-gradient(120% 120% at 30% 30%, #ffffff 0%, #e8e9ec 25%, #cfd1d6 45%, #a8a9ad 62%, #8b8c90 75%, #6e6f73 100%);
      box-shadow:
        inset 6px 6px 10px rgba(255,255,255,.85),
        inset -6px -6px 12px rgba(0,0,0,.25),
        0 8px 18px rgba(0,0,0,.15);
    }
    .ring::after{
      /* فتحة داخلية */
      content:"";
      position:absolute;
      inset:8px;
      border-radius:50%;
      background:
        radial-gradient(120% 120% at 70% 70%, #f7f7f9 0%, #dfe1e6 45%, #b9bbc2 70%, #94969d 100%);
      box-shadow:
        inset 3px 3px 6px rgba(255,255,255,.8),
        inset -3px -3px 6px rgba(0,0,0,.25);
    }
    .ring-top{ margin-bottom:70px; }
    .ring-bottom{ margin-top:70px; }

    /* ===== صفحات كاملة (Overlays) ===== */
    .page-overlay{
      position:fixed; inset:0; background:#f7f8fb; z-index:99; display:none;
      overflow:auto; -webkit-overflow-scrolling:touch;
    }
    .page-overlay.active{ display:block; }
    .page{
      max-width:1200px; margin:0 auto; padding:20px 16px 80px;
    }
    .page .page-card{
      background:var(--paper);
      border-radius:22px;
      box-shadow:0 8px 26px rgba(0,0,0,.10);
      padding:22px;
    }
    .page-header{
      display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:14px;
    }
    .back-btn{
      display:inline-flex; align-items:center; gap:8px;
      background:var(--navy); color:#fff; border:none; border-radius:10px; padding:10px 14px; cursor:pointer;
      box-shadow:0 3px 8px rgba(0,0,0,.15);
    }
    .page-title{ margin:0; font-weight:700; font-size:1.15em; color:#222; }

    /* ===== مسطرة عامة ===== */
    .ruled{
      background-image:
        linear-gradient(to bottom, transparent calc(100% - 1px), var(--ruled-line) calc(100% - 1px)),
        linear-gradient(to right, rgba(0,0,0,0.02), rgba(0,0,0,0.02));
      background-size: 100% 34px, 100% 100%;
      background-repeat:repeat;
      border:1px solid #eee;
      border-radius:12px;
    }

    /* ===== قوائم Checkbox مسطرة ===== */
    .checkbox-ruled{
      display:flex; flex-direction:column; padding:8px 10px; max-height:70vh; overflow:auto;
    }
    .checkbox-ruled .item{
      display:flex; align-items:center; gap:10px; height:34px; border-bottom:1px solid var(--ruled-line);
    }
    .checkbox-ruled .item:last-child{ border-bottom:none; }
    .checkbox-ruled input[type="checkbox"]{ transform:scale(1.2); accent-color:var(--ruby); margin-left:6px; }
    .checkbox-ruled .line{ flex:1; height:100%; }

    .toolbar{ display:flex; gap:8px; align-items:center; margin-bottom:10px; flex-wrap:wrap; }
    .toolbar .btn{
      background:#fff; border:1px solid #e6e6e9; border-radius:10px; padding:8px 10px; cursor:pointer; font-size:.95em;
    }
    .toolbar .btn i{ margin-left:6px; color:#7b7b7f; }
    .toolbar .btn:hover{ background:#fafafa; }

    /* ===== جدول المصروفات: دفتر محاسبي مسطر (بدون أزرار/حقول) ===== */
    .ledger-wrap{ overflow:auto; }
    .ledger-table{
      width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed;
      border:1px solid #ececf0; border-radius:14px; overflow:hidden;
      box-shadow:0 2px 10px rgba(0,0,0,.05);
    }
    .ledger-table thead th{
      background:#f6efe6; color:#3b2f22; font-weight:700; text-align:center; padding:12px 8px;
      border-bottom:1px solid #e8e0d5;
      position:sticky; top:0; z-index:1;
    }
    .ledger-table tbody td{
      background:
        linear-gradient(to bottom, transparent 33px, var(--ruled-line) 33px),
        #fff;
      background-size:100% 34px, 100% 100%;
      height:34px; padding:6px 8px; border-right:1px solid #f0f0f2; text-align:right; color:#333;
    }
    .ledger-table tbody td:last-child{ border-right:none; }
    .ledger-table tr:last-child td{ box-shadow: inset 0 -1px 0 var(--ruled-line); }

    /* ===== بطاقات الرسم/الكتابة الحرة ===== */
    .cards-grid{
      display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:14px;
    }
    .draw-card{
      position:relative; border:1px solid #eee; border-radius:14px; overflow:hidden; background:#fff;
      box-shadow: 0 2px 12px rgba(0,0,0,.05);
    }
    .draw-card .card-toolbar{
      position:absolute; top:8px; left:8px; z-index:2; display:flex; gap:6px;
      background:rgba(255,255,255,.88); border:1px solid #eee; border-radius:10px; padding:4px 6px; align-items:center;
      backdrop-filter: saturate(120%) blur(2px);
    }
    .draw-card .card-toolbar button,
    .draw-card .card-toolbar input[type="color"],
    .draw-card .card-toolbar input[type="range"]{
      border:1px solid #ddd; background:#fff; border-radius:8px; padding:4px 6px; cursor:pointer;
    }
    .draw-card .card-toolbar button:hover{ background:#fafafa; }
    .draw-card .ruled{ height:260px; }
    .draw-card canvas{ position:absolute; inset:0; width:100%; height:100%; touch-action:none; }

    /* ===== شريط التحضير اليومي الصغير (أفقي جداً) ===== */
    .prep-strip{
      display:grid;
      grid-template-columns: auto 140px auto 180px repeat(8, minmax(60px,1fr));
      gap:8px; align-items:center; margin-bottom:12px;
    }
    .prep-strip .label{ font-weight:700; color:#564939; font-size:.95em; }
    .prep-strip .box{
      height:34px; border:1px solid #e6e2db; border-radius:10px; background:#fff; position:relative;
      box-shadow: inset 0 -1px 0 var(--ruled-line);
    }
    .prep-strip .box.ruled{
      background-image: linear-gradient(to bottom, transparent calc(100% - 1px), var(--ruled-line) calc(100% - 1px));
      background-size:100% 34px;
    }
    .prep-strip .box[data-n]::before{
      content: attr(data-n);
      position:absolute; top:4px; left:6px; font-size:.8em; color:#9a8364;
    }

    /* ===== التقويم المصغر ===== */
    .footer-calendars{ margin-top:auto; border-top:1px solid #eee; padding-top:16px; }
    .months-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }
    .mini-month{
      background:#fff; border:1px solid #eee; border-radius:12px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,.04);
    }
    .mini-month .mh{
      background:#f6efe6; color:#3b2f22; padding:8px 10px; font-weight:700; font-size:.95em; border-bottom:1px solid #e8e0d5;
    }
    .mini-month table{ width:100%; border-collapse:collapse; table-layout:fixed; }
    .mini-month th, .mini-month td{ text-align:center; font-size:.85em; padding:6px 0; border-bottom:1px solid #fafafa; }
    .mini-month tr:last-child td{ border-bottom:none; }
    .mini-month .wk th{ background:#fdfbf8; color:#7b6b59; font-weight:700; }
    .mini-month td.empty{ background:#fcfcfc; color:#c9c9c9; }

    /* استجابة */
    @media (max-width:1200px){
      .planner-container{ flex-direction:column; gap:18px; }
      .center-binder{ height:62px; width:auto; min-width:unset; margin:8px 0; padding:0; flex-direction:row; gap:30px; }
      .ring-top{ margin:0; }
      .ring-bottom{ margin:0; }
    }
    @media (max-width:768px){
      .planner-page{ padding:20px; border-radius:16px; }
      .header .logo{ font-size:2em; }
      .tabs-section .tab-button{ padding:10px 14px; }
      .months-grid{ grid-template-columns:1fr 1fr; }
      .prep-strip{ grid-template-columns: auto 120px auto 150px repeat(8, minmax(44px,1fr)); }
    }
  </style>
</head>
<body id="home">

  <div class="planner-container">

    <!-- الصفحة اليمنى: شخصية -->
    <div class="planner-page personal-page">
      <div class="header">
        <div class="logo">MYH</div>
        <div class="title">
          <h1>صفحة الحياة اليومية الشخصية</h1>
          <p>أ/ محمد ياسين حلمي - مخطط 2026</p>
        </div>
      </div>

      <div class="tabs-section">
        <a class="tab-button tab-ruby" href="#page-personal-tasks">
          <i class="fas fa-tasks"></i><span>مهام اليوم</span>
        </a>
        <a class="tab-button tab-navy" href="#page-expenses">
          <i class="fas fa-wallet"></i><span>المصروفات</span>
        </a>
        <a class="tab-button tab-emerald" href="#page-personal-notes">
          <i class="fas fa-clipboard"></i><span>ملاحظات</span>
        </a>
      </div>

      <div class="placeholder-note">
        اضغط أي تبويب ليفتح صفحة كاملة مصمّمة للآيباد (كتابة بالقلم / إدخال بالقلم).
      </div>

      <!-- تقويم يناير–مارس 2026 -->
      <div class="footer-calendars">
        <div class="months-grid" id="right-months"></div>
      </div>
    </div>

    <!-- الفاصل الحلقي الفضي (حلقتان) -->
    <div class="center-binder" aria-hidden="true">
      <div class="ring ring-top"></div>
      <div class="ring ring-bottom"></div>
    </div>

    <!-- الصفحة اليسرى: مهنية -->
    <div class="planner-page professional-page">
      <div class="header">
        <div class="logo">MYH</div>
        <div class="title">
          <h1>مركز المعلم الاحترافي</h1>
          <p>أ/ محمد ياسين حلمي - مخطط معلم الفنون 2026</p>
        </div>
      </div>

      <div class="tabs-section">
        <a class="tab-button tab-navy" id="btn-daily-prep" href="#page-daily-preparation" title="التحضير اليومي">
          <i class="fas fa-palette"></i><span>التحضير اليومي</span>
        </a>
        <a class="tab-button tab-white" href="#page-professional-tasks">
          <i class="fas fa-check-square"></i><span>المهام اليومية</span>
        </a>
        <a class="tab-button tab-emerald" href="#page-creative-ideas">
          <i class="fas fa-lightbulb"></i><span>Creative Ideas</span>
        </a>
        <a class="tab-button tab-marmoreal" href="#page-sunday">
          <i class="fas fa-calendar-day"></i><span>أحد الأسبوع</span>
        </a>
      </div>

      <div class="placeholder-note">
        ملاحظة: التحضير اليومي مفعّل من الأحد إلى الخميس فقط. تبويب أحد الأسبوع يوفر ١٠ بطاقات للكتابة بالقلم.
      </div>

      <!-- تقويم أبريل–يونيو 2026 -->
      <div class="footer-calendars">
        <div class="months-grid" id="left-months"></div>
      </div>
    </div>
  </div>

  <!-- ========= الصفحات الكاملة ========= -->

  <!-- يمين: مهام اليوم -->
  <div class="page-overlay" id="page-personal-tasks" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">مهام اليوم - صفحة مسطّرة</h2>
      </div>
      <div class="page-card">
        <div class="toolbar">
          <button class="btn" data-add-line="#personalTasksList"><i class="fa fa-plus"></i>إضافة سطر</button>
          <button class="btn" data-clear-lines="#personalTasksList"><i class="fa fa-trash"></i>تفريغ القائمة</button>
        </div>
        <div class="ruled checkbox-ruled" id="personalTasksList"></div>
      </div>
    </div>
  </div>

  <!-- يمين: المصروفات (دفتر محاسبي مسطر) -->
  <div class="page-overlay" id="page-expenses" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">تتبع المصروفات - صفحة دفترية مسطّرة</h2>
      </div>
      <div class="page-card">
        <div class="ledger-wrap">
          <table class="ledger-table" id="ledgerTable">
            <thead>
              <tr>
                <th>الرصيد</th>
                <th>viza</th>
                <th>walleti</th>
                <th>البند</th>
                <th>المصروف</th>
                <th>ملاحظات</th>
              </tr>
            </thead>
            <tbody>
              <!-- تُولّد صفوف فارغة عبر JS -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- يمين: ملاحظات (مسطرة + ورقة اليوم) -->
  <div class="page-overlay" id="page-personal-notes" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">ملاحظات شخصية</h2>
      </div>
      <div class="page-card">
        <div class="ruled" style="min-height:70vh; position:relative;">
          <div style="position:absolute; top:10px; left:10px; background:#fff7ea; color:#5b3c1e; border:1px dashed #e8d2b8; padding:6px 10px; border-radius:10px; font-size:.9em;" id="todaySlip">
            <i class="fa fa-calendar"></i> <span>اليوم - التاريخ</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- يسار: التحضير اليومي -->
  <div class="page-overlay" id="page-daily-preparation" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">التحضير اليومي</h2>
      </div>
      <div class="page-card">
        <!-- شريط علوي صغير جداً -->
        <div class="prep-strip">
          <div class="label">الصف</div>
          <div class="box ruled" id="prep-class" title="اكتب الصف بالقلم"></div>
          <div class="label">اليوم</div>
          <div class="box ruled" id="prep-day" title="اليوم والتاريخ"></div>
          <div class="box ruled" data-n="١" title="حصة 1"></div>
          <div class="box ruled" data-n="٢" title="حصة 2"></div>
          <div class="box ruled" data-n="٣" title="حصة 3"></div>
          <div class="box ruled" data-n="٤" title="حصة 4"></div>
          <div class="box ruled" data-n="٥" title="حصة 5"></div>
          <div class="box ruled" data-n="٦" title="حصة 6"></div>
          <div class="box ruled" data-n="٧" title="حصة 7"></div>
          <div class="box ruled" data-n="٨" title="حصة 8"></div>
        </div>

        <!-- 5 بطاقات كبيرة -->
        <div class="cards-grid" id="prepCards"></div>
      </div>
    </div>
  </div>

  <!-- يسار: المهام اليومية -->
  <div class="page-overlay" id="page-professional-tasks" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">المهام اليومية المهنية</h2>
      </div>
      <div class="page-card">
        <div class="toolbar">
          <button class="btn" data-add-line="#professionalTasksList"><i class="fa fa-plus"></i>إضافة سطر</button>
          <button class="btn" data-clear-lines="#professionalTasksList"><i class="fa fa-trash"></i>تفريغ القائمة</button>
        </div>
        <div class="ruled checkbox-ruled" id="professionalTasksList"></div>
      </div>
    </div>
  </div>

  <!-- يسار: Creative Ideas -->
  <div class="page-overlay" id="page-creative-ideas" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">Creative Ideas - كتابة حرة</h2>
      </div>
      <div class="page-card">
        <div class="ruled" style="min-height:70vh;"></div>
      </div>
    </div>
  </div>

  <!-- يسار: أحد الأسبوع (10 بطاقات) -->
  <div class="page-overlay" id="page-sunday" role="dialog" aria-modal="true">
    <div class="page">
      <div class="page-header">
        <a class="back-btn" href="#home"><i class="fa fa-arrow-right"></i>رجوع</a>
        <h2 class="page-title">أحد الأسبوع - بطاقات للكتابة بالقلم</h2>
      </div>
      <div class="page-card">
        <div class="cards-grid" id="sundayCards"></div>
      </div>
    </div>
  </div>

  <script>
    // ===== أدوات عامة =====
    function closeAllOverlays(){
      document.querySelectorAll('.page-overlay').forEach(el=> el.classList.remove('active'));
      // إزالة إبراز التبويبات
      document.querySelectorAll('.tab-button').forEach(b=> b.classList.remove('active'));
    }
    function openOverlayById(id){
      const el=document.getElementById(id);
      if(!el) return;
      closeAllOverlays();
      el.classList.add('active');
      // إبراز التبويب الموافق (إن وجد)
      const tab = document.querySelector('.tab-button[href="#'+id+'"]');
      if(tab) tab.classList.add('active');
    }
    function openFromHash(){
      const h = window.location.hash || '#home';
      if(h==='#home' || h==='#' || h===''){ closeAllOverlays(); return; }
      const id = h.substring(1);
      openOverlayById(id);
    }
    function todayInfo(){
      const d=new Date();
      const locale='ar-EG';
      const dayName=d.toLocaleDateString(locale,{weekday:'long'});
      const dateStr=d.toLocaleDateString(locale,{year:'numeric',month:'long',day:'numeric'});
      return {d, dayName, dateStr};
    }
    function isSunToThu(dateObj){ const n=dateObj.getDay(); return (n>=0 && n<=4); } // أحد..خميس
    function isSunday(dateObj){ return dateObj.getDay()===0; }

    // ===== قوائم Checkbox =====
    function addCheckboxLine(container){
      const line=document.createElement('div'); line.className='item';
      const cb=document.createElement('input'); cb.type='checkbox';
      const span=document.createElement('div'); span.className='line';
      line.appendChild(cb); line.appendChild(span); container.appendChild(line);
    }
    function fillCheckboxLines(container,count){ for(let i=0;i<count;i++) addCheckboxLine(container); }
    function clearCheckboxLines(container){ container.innerHTML=''; }

    // ===== بطاقات الرسم (Canvas) =====
    function setupDrawCard(cardEl){
      const ruled=document.createElement('div'); ruled.className='ruled'; cardEl.appendChild(ruled);
      const canvas=document.createElement('canvas'); cardEl.appendChild(canvas);
      const toolbar=document.createElement('div'); toolbar.className='card-toolbar';
      const clrBtn=document.createElement('button'); clrBtn.innerHTML='<i class="fa fa-eraser"></i>مسح';
      const colorInp=document.createElement('input'); colorInp.type='color'; colorInp.value='#333333';
      const rangeInp=document.createElement('input'); rangeInp.type='range'; rangeInp.min='1'; rangeInp.max='8'; rangeInp.value='2';
      toolbar.appendChild(colorInp); toolbar.appendChild(rangeInp); toolbar.appendChild(clrBtn); cardEl.appendChild(toolbar);

      const ctx=canvas.getContext('2d');
      let drawing=false,lastX=0,lastY=0,strokeStyle=colorInp.value,lineW=parseInt(rangeInp.value,10);

      function resize(){
        const prev=document.createElement('canvas'); prev.width=canvas.width; prev.height=canvas.height;
        prev.getContext('2d').drawImage(canvas,0,0);
        const rect=cardEl.getBoundingClientRect();
        canvas.width=rect.width; canvas.height=rect.height;
        ctx.drawImage(prev,0,0,prev.width,prev.height,0,0,canvas.width,canvas.height);
      }
      new ResizeObserver(resize).observe(cardEl); setTimeout(resize,60);

      function pos(e){
        const r=canvas.getBoundingClientRect();
        if(e.touches && e.touches.length){ return {x:e.touches[0].clientX-r.left, y:e.touches[0].clientY-r.top}; }
        return {x:e.clientX-r.left, y:e.clientY-r.top};
      }
      function start(e){ e.preventDefault(); drawing=true; const p=pos(e); lastX=p.x; lastY=p.y; }
      function move(e){
        if(!drawing) return; const p=pos(e);
        ctx.strokeStyle=strokeStyle; ctx.lineWidth=lineW; ctx.lineCap='round'; ctx.lineJoin='round';
        ctx.beginPath(); ctx.moveTo(lastX,lastY); ctx.lineTo(p.x,p.y); ctx.stroke();
        lastX=p.x; lastY=p.y;
      }
      function end(){ drawing=false; }

      canvas.addEventListener('pointerdown',start);
      canvas.addEventListener('pointermove',move);
      window.addEventListener('pointerup',end);
      canvas.addEventListener('touchstart',start,{passive:false});
      canvas.addEventListener('touchmove',move,{passive:false});
      window.addEventListener('touchend',end);

      clrBtn.addEventListener('click',()=>ctx.clearRect(0,0,canvas.width,canvas.height));
      colorInp.addEventListener('input',()=>strokeStyle=colorInp.value);
      rangeInp.addEventListener('input',()=>lineW=parseInt(rangeInp.value,10));
    }

    // ===== التقويم المصغر =====
    const monthsNames=['يناير','فبراير','مارس','أبريل','مايو','يونيو','يوليو','أغسطس','سبتمبر','أكتوبر','نوفمبر','ديسمبر'];
    const weekNamesShort=['أحد','اثن','ثلا','أرب','خمي','جمع','سبت'];
    function miniMonth(year,monthIdx){
      const first=new Date(year,monthIdx,1), last=new Date(year,monthIdx+1,0);
      const firstW=first.getDay(), days=last.getDate();
      const wrapper=document.createElement('div'); wrapper.className='mini-month';
      const head=document.createElement('div'); head.className='mh'; head.textContent=monthsNames[monthIdx]+' '+year; wrapper.appendChild(head);
      const table=document.createElement('table');
      const trh=document.createElement('tr'); trh.className='wk';
      weekNamesShort.forEach(w=>{ const th=document.createElement('th'); th.textContent=w; trh.appendChild(th); });
      table.appendChild(trh);
      let tr=document.createElement('tr');
      for(let i=0;i<firstW;i++){ const td=document.createElement('td'); td.className='empty'; tr.appendChild(td); }
      let dow=firstW;
      for(let d=1; d<=days; d++){
        if(dow===7){ table.appendChild(tr); tr=document.createElement('tr'); dow=0; }
        const td=document.createElement('td'); td.textContent=d; tr.appendChild(td); dow++;
      }
      if(dow>0 && dow<7){ for(let i=dow;i<7;i++){ const td=document.createElement('td'); td.className='empty'; tr.appendChild(td); } }
      table.appendChild(tr); wrapper.appendChild(table);
      return wrapper;
    }
    function renderCalendars(){
      const right=document.getElementById('right-months');
      const left=document.getElementById('left-months');
      [0,1,2].forEach(m=> right.appendChild(miniMonth(2026,m))); // يناير-مارس
      [3,4,5].forEach(m=> left.appendChild(miniMonth(2026,m)));  // أبريل-يونيو
    }

    // ===== جدول المصروفات: توليد سطور فارغة =====
    function buildLedgerRows(rows=24){
      const tb=document.querySelector('#ledgerTable tbody');
      tb.innerHTML='';
      for(let r=0; r<rows; r++){
        const tr=document.createElement('tr');
        for(let c=0;c<6;c++){ const td=document.createElement('td'); td.innerHTML='&nbsp;'; tr.appendChild(td); }
        tb.appendChild(tr);
      }
    }

    // ===== تهيئة الصفحة + الروابط الداخلية =====
    document.addEventListener('DOMContentLoaded', ()=>{
      const info=todayInfo();

      // التحضير اليومي: تفعيل فقط أحد-خميس
      const btnPrep=document.getElementById('btn-daily-prep');
      if(!isSunToThu(info.d)){
        // اجعله مُعطلاً بصرياً ويمنع الضغط
        btnPrep.classList.add('disabled');
        btnPrep.setAttribute('aria-disabled','true');
        btnPrep.addEventListener('click',(e)=>{ e.preventDefault(); });
        btnPrep.title='يتاح من الأحد إلى الخميس فقط';
      }

      // ملاحظات: ورقة اليوم
      const todaySlip=document.getElementById('todaySlip');
      if(todaySlip){ todaySlip.querySelector('span').textContent = info.dayName+' - '+info.dateStr; }

      // التحضير: اليوم (صندوق صغير)، الصف يكتب بالقلم
      const prepDay=document.getElementById('prep-day');
      if(prepDay){ prepDay.textContent = info.dayName+' - '+info.dateStr; }

      // مهام: املأ أسطر افتراضية
      const personalTasks=document.getElementById('personalTasksList');
      const professionalTasks=document.getElementById('professionalTasksList');
      if(personalTasks) fillCheckboxLines(personalTasks, 18);
      if(professionalTasks) fillCheckboxLines(professionalTasks, 16);

      // المصروفات: سطور دفترية فارغة
      buildLedgerRows(24);

      // بطاقات التحضير (5)
      const prepCards=document.getElementById('prepCards');
      for(let i=0;i<5;i++){ const c=document.createElement('div'); c.className='draw-card'; setupDrawCard(c); prepCards.appendChild(c); }

      // بطاقات الأحد (10)
      const sundayCards=document.getElementById('sundayCards');
      for(let i=0;i<10;i++){ const c=document.createElement('div'); c.className='draw-card'; setupDrawCard(c); sundayCards.appendChild(c); }

      // التقويم
      renderCalendars();

      // افتح/أغلق الصفحات بناءً على الرابط الداخلي
      window.addEventListener('hashchange', openFromHash);
      openFromHash();
    });
  </script>
</body>
</html>
